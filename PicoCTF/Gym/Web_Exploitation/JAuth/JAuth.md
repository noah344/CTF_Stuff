# JAuth
This was a challenge listed exclusively for the Pico Gym.  It's listed as Medium and categorized as a Web Exploitation challenge.  
Direct Link:  https://play.picoctf.org/practice/challenge/236

## Description
The Description reads:
> Most web application developers use third party components without testing their security. Some of the past affected companies are:

    Equifax (a US credit bureau organization) - breach due to unpatched Apache Struts web framework CVE-2017-5638
    Mossack Fonesca (Panama Papers law firm) breach - unpatched version of Drupal CMS used
    VerticalScope (internet media company) - outdated version of vBulletin forum software used

> Can you identify the components and exploit the vulnerable one?

## Hints
There are two hints:
> Use the web browser tools to check out the JWT cookie.
> The JWT should always have two (2) . separators.

# Solving
## My Thoughts
This was a new concept to me.  I've messed with cookies before but not specifically JWT.  I always enjoy learning new things and this was an enjoyable one!

# Logging In
The webpage looks like this on initial access, the challenge tells us we can login initially with test and Test123!:

<img width="1578" height="901" alt="image" src="https://github.com/user-attachments/assets/57ae1dcd-b291-4816-9f7c-2164567d8457" />

Nothing particularly interesting, let's go ahead and login and see what we find:

<img width="1787" height="817" alt="image" src="https://github.com/user-attachments/assets/745dc316-201c-489b-9e80-d041a8489835" />

Again nothing helpful, at least in the sourcecode.  Let's go look at our cookies (the challenges title of JWT hints that cookies are probably the way to go):

<img width="545" height="82" alt="image" src="https://github.com/user-attachments/assets/2d1a8242-f50b-479a-b62a-4758e539ff2f" />

Sure enough, we've got a cookie!  Let's do some research on JWT vulnerabilities now, [this](https://jwt.io/) helpful website let's us pull apart the token:

<img width="1352" height="770" alt="image" src="https://github.com/user-attachments/assets/c81fe976-9c49-4278-be1b-a56abbe22661" />

Ok cool! I have a feeling it won't work because of the signature, but what'll happen if we modify the token to make us an admin and then refresh the page?

Let's try it:

<img width="1415" height="808" alt="image" src="https://github.com/user-attachments/assets/65a13ac1-83de-4e26-88f1-96f1ff2889fd" />

As you can see, the signature has been modified.  This won't work!  Let's do some more research, PortSwigger has a full page on JWT vulnerabilities [here](https://portswigger.net/web-security/jwt).

The very first thing on that page suggests setting the alg to none and removing the signature to see if the web server accepts it, so lets try that:

<img width="1395" height="613" alt="image" src="https://github.com/user-attachments/assets/d05c50cf-ef6a-4743-8074-157a9fcd1c22" />

And now let's toss that in our website and see what happens:

<img width="1041" height="262" alt="image" src="https://github.com/user-attachments/assets/ce8f7c12-c1e8-4671-a08e-21b515650051" />

Awesome! We got the flag!

One last thing, it turns out that the actual paramaters are just base64 encoded data, although cyberchef ALSO has a JWT decoder as well:

<img width="1547" height="684" alt="image" src="https://github.com/user-attachments/assets/fd6b548e-036f-4e1f-b7fb-3fb01a292f85" />
