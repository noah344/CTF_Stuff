# n0s4n1ty 1
This was the third challenge listed in PicoCTF 2025.  It's listed as easy and categorized as a Web Exploitation challenge.

## Description
The Description reads:
> A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the /root directory.
>
> Additional details will be available after launching your challenge instance.
## Hints
There are two hints that read:
> File upload was not sanitized

and  
> Whenever you get a shell on a remote machine, check sudo -l

# Solving
## My Feelings
This challenge was another interesting one, it's a classic spin on php injection via file upload and does a great job of introducing some new concepts.  It's one of those where I knew what needed to be done pretty much immediately, but took quite some time to actually pin down the details.

## PHP Injection
PHP is a massive framework used to create dynamic web pages, what this means it that it communicates back and forth between the front-end that the user interacts with and the server itself.  Because of this, there are some inherent vulnerabilities in PHP that have to be accounted for when developing web apps.  If a user can somehow get the server to interpet user-provided PHP, the user can do an awful lot of bad things on the server.  This is known as PHP Injection and is a pretty common theme in CTFs.  

PHP Injection, when executed successfully, leads to RCE (Remote Code Execution).  But why mention PHP at all?

## The Webpage
The webpage is a very simple upload utility allowing the user to upload an image:

![Upload](https://github.com/user-attachments/assets/4ac1df29-ec05-43ef-ac1a-260b32060992)

After uploading an image, your greeted with the below message:

> The file mow.jpg has been uploaded Path: uploads/mow.jpg 

And when we navigate to it we can see the uploaded image:

![Mow](https://github.com/user-attachments/assets/1661e264-e4c8-4fa2-a55a-425cf88afcaa)

Now, when we initially upload the image, a POST request is sent to an upload.php page:

> POST http://standard-pizzas.picoctf.net:58972/upload.php

All of these things combined indicate that some form of PHP injection via file upload is the way to go.  One of the hints very clearly states that there is no file upload sanitization so, let's give it a try!

We know that the flag should be in /root/flag.txt, and in PHP you can execute system commands by using the 'exec' function, so the below is the payload that I setup in payload.php:

``` php
<?php
echo exec("sudo cat /root/flag.txt"); 
?>
```

Let's go ahead and upload that and see what we get!

![PHP Injection](https://github.com/user-attachments/assets/a5135ebd-7d8f-4844-99d5-f6393320df48)

Nice, flag gotten!




