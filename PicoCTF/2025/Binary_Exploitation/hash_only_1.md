# Hash Only 1
This was a challenge listed in PicoCTF 2025.  It's listed as medium and categorized as a Binary Exploitation challenge.

## Description
The Description reads:
> Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash.  
> If only it could just give you the actual content!

## Hints
There are no hints for this challenge.

# Solving
## My Thoughts
This challenge barely qualifies as binary exploitation to me, which made the challenge a little annoying as I started looking in the wrong place at first.  On top of this, many of the normally useful commands were not available which just made this challenge annoying by artificially inflating the difficulty.

## Strings
A useful command on Linux when dealing with binary executables is 'strings'.  Strings will automatically go through the binary data and grab any text that appears to be readable, spitting it out for you.  I ran through strings and found a few lines that were useful:

```
Computing the MD5 hash of /root/flag.txt....
/bin/bash -c 'md5sum /root/flag.txt'
Error: system() call returned non-zero value:
```

So this executable simply reads in the flag located at /root/flag.txt and converts it to an md5 hash via the md5sum program that comes with linux.  Ok cool, let's check the permissions of the executable:

## Permissions

``` bash
ctf-player@pico-chall$ ls -l flaghasher
-rwsr-xr-x 1 root root 18312 Mar  6 03:45 flaghasher
```

Two things, this file is owned by root but is in the ctf-player home directory.  It's also executable by everybody but not writable.  Second, the sticky bit is set on the executable.  

If you aren't aware, the sticky bit is a very common CTF gimmick that (in my experience) is not particularly relevant in the real world.  The sticky bit essentially forces the executable to run with the rights of the owner of the file, regardless of who is running it.

## Sticky Bit
Another common gimmick that often goes along with the sticky bit is manipulating path variables.  You'll notice in the strings above that the md5sum is not called directly by it's location (e.g. /usr/bin/md5sum), it's installed simply written out as md5sum.  

There is a variable known as the path which links to various directories where executables can be found, it essentially makes it so you can call programs without having to explicitly state where they are at.  If we can manipulate this path to point to a program of our own design, we can get the flag output.  So lets start by writing out a really simple bash script.

## Bash Script
If we were to simply create a bash script that read in whatever file it's passed, we could get the flag.  So let's do that, I simply created a bash script in the local directory named 'md5sum' and placed this line within:

``` bash
cat /root/flag.txt
```

Of course vi was disabled because reasons so we had to just echo the line to the file 'echo "cat /root/flag.txt" >> ~/md5sum'.  You then need to run the below command to give it execute permissions:

``` bash
chmod +x md5sum
```

## Changing Path
Now we need to update the path variable so that running the flaghasher executable will instead call our local script.  This can be done like so:

``` bash
export PATH=/home/ctf-player:$PATH
```

We append the old path to the end to make sure it searches through the local directory before the rest.  Once we do that we get the flag:

![Flag](https://github.com/user-attachments/assets/309d32c5-d59f-4765-9e0e-736689398c06)
